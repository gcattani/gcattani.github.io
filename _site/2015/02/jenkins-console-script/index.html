<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="description" content=Giovanni Cattani's Blog>
      <meta name="author" content=Giovanni Cattani>
      <meta name="viewport" content="width=device-width">
      <link rel="stylesheet" href="/css/syntax.css">
      <link rel="stylesheet" href="/css/main.css">
      <link rel="stylesheet" href="/css/normalize.css">
      <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
      <link rel="icon" href="/favicon.ico" type="image/x-icon">
      <link rel="alternate" type="application/atom+xml" href="/atom.xml">
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
   })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

   ga('create', 'UA-39540268-1', 'gcattani.co.vu');
   ga('send', 'pageview');
</script>

      <title>Exploiting Jenkins Console Script</title>
   </head>
   
   <body>
      <main>
         <header>
            <h1 class="title"><a href="/">BoringSec</a></h1>
         </header>

         <article>
   <h2>Exploiting Jenkins Console Script</h2>
   <hr>
   <p>During a recent Penetration Test, I found an unauthenticated instance of <a href="http://jenkins-ci.org/">Jenkins</a>, an open source continuous integration (CI) tool.</p>

<p><img src="/img/2015-02-28-jenkins-console-script/Jenkins-No-Auth.png" alt="Unauthenticated Jenkins Web Application"></p>

<p>While browsing the web application for interesting information, the <em>Jenkins Console Script</em> (&#39;http://jenkins/script&#39;) got my attention. This feature allows users to execute arbitrary <a href="http://groovy.codehaus.org/">Groovy</a> scripts directly on the server and, with a little help from Stack Overflow, I quickly pulled together the following code to execute any command.</p>

<div class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="kt">def</span> <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;whoami&quot;&quot;&quot;</span>
<span class="kt">def</span> <span class="n">proc</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="na">execute</span><span class="o">()</span>
<span class="n">proc</span><span class="o">.</span><span class="na">waitFor</span><span class="o">()</span>

<span class="n">println</span> <span class="s2">&quot;return code: ${ proc.exitValue()}&quot;</span>
<span class="n">println</span> <span class="s2">&quot;stderr: ${proc.err.text}&quot;</span>
<span class="n">println</span> <span class="s2">&quot;stdout: ${proc.in.text}&quot;</span></code></pre></div>

<p>Using the script to browse the server&#39;s file system, a file that included authentication credentials for an additional corporate application was identified. Access to this service allowed the disclosure of the whole source code of the customer&#39;s applications.</p>

<p><img src="/img/2015-02-28-jenkins-console-script/Jenkins-Read-Credentials.png" alt="Reading Credentials via Console Script"></p>

<p>The default configuration of Jenkins does not perform any security check and does not enforce user authentication, allowing anyone to access the web application, configure Jenkins and its jobs, perform builds, etc.</p>

<p>As stated in the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+Best+Practices">Jenkins Best Practice</a>, it is very important to <em>always secure Jenkins</em>, even when it is implemented for intranet use only (as demonstrated during this Penetration Test). If interested, take a look at the official <a href="https://wiki.jenkins-ci.org/display/JENKINS/Securing+Jenkins">Securing Jenkins</a> article.</p>

</article>

<footer>
   <div id="date" class="meta">
      27 Feb 2015
   </div>
   <div id="return">
      <a href="/">&laquo; Home Page</a>
   </div>
   <br>
</footer>

      </main>
   </body>
</html>
